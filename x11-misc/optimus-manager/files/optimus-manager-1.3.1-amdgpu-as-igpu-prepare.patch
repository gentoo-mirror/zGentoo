From 6775ab3ba4056ad823a115d2949677f5afaf02d9 Mon Sep 17 00:00:00 2001
From: Robin Lange <robin.langenc@gmail.com>
Date: Sun, 5 Jul 2020 16:31:04 +1000
Subject: [PATCH 03/10] PKGBUILD: use absolute path for Python interpreter

Fixes https://github.com/Askannz/optimus-manager/issues/278
---
 package/PKGBUILD | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/package/PKGBUILD b/package/PKGBUILD
index ce3769f..9a0f847 100644
--- a/package/PKGBUILD
+++ b/package/PKGBUILD
@@ -36,7 +36,7 @@ pkgver() {
 build() {
  
   cd "${srcdir}/optimus-manager/"
-  python3 setup.py build
+  /usr/bin/python3 setup.py build
  
 }
  
@@ -67,6 +67,6 @@ package() {
   install -Dm755 config/nvidia-enable.sh "$pkgdir/etc/optimus-manager/nvidia-enable.sh"
   install -Dm755 config/nvidia-disable.sh "$pkgdir/etc/optimus-manager/nvidia-disable.sh"
  
-  python3 setup.py install --root="$pkgdir/" --optimize=1 --skip-build
+  /usr/bin/python3 setup.py install --root="$pkgdir/" --optimize=1 --skip-build
  
 } 

From 36dd291096d2e44970983a6a5f5b5fbb5c64894e Mon Sep 17 00:00:00 2001
From: Ramprakash Chandrashekar <ramprakash.chandrashekar@gmail.com>
Date: Sun, 5 Jul 2020 20:51:04 +0530
Subject: [PATCH 04/10] fix: Remove unnecessary newline in output

---
 optimus_manager/client/__init__.py | 1 -
 1 file changed, 1 deletion(-)

diff --git a/optimus_manager/client/__init__.py b/optimus_manager/client/__init__.py
index 6a19235..4485d55 100644
--- a/optimus_manager/client/__init__.py
+++ b/optimus_manager/client/__init__.py
@@ -24,7 +24,6 @@ def main():
     fatal = report_errors(state)
 
     config = _get_config()
-    print("")
 
     if args.version:
         _print_version()

From a5b04156bad51254eb41cccf77e1ec86f3d518cf Mon Sep 17 00:00:00 2001
From: "Petrus.Z" <silencly07@gmail.com>
Date: Tue, 7 Jul 2020 14:22:11 +0800
Subject: [PATCH 05/10] Add acpi_string for legion R7000 laptop and GTX 1650
 GPU

And stop continue trying when there is a successful acpi call

Signed-off-by: Petrus.Z <silencly07@gmail.com>
---
 optimus_manager/acpi_data.py | 2 +-
 optimus_manager/kernel.py    | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/optimus_manager/acpi_data.py b/optimus_manager/acpi_data.py
index ab771c9..49fda13 100644
--- a/optimus_manager/acpi_data.py
+++ b/optimus_manager/acpi_data.py
@@ -25,6 +25,6 @@
     ("\\_SB.PCI0.LPC.EC.PUBS._OFF", "\\_SB.PCI0.LPC.EC.PUBS._ON"),
     ("\\_SB.PCI0.P0P2.NVID._OFF", "\\_SB.PCI0.P0P2.NVID._ON"),
     ("\\_SB_.PCI0.PEGP.DGFX._OFF", "\\_SB_.PCI0.PEGP.DGFX._ON"),
+    ("\\_SB.PCI0.GPP0.PG00._OFF'", "\\_SB.PCI0.GPP0.PG00._ON"),
     ("\\_SB.PCI0.PEG0.PEGP.SGOF", "\\_SB.PCI0.PEG0.PEGP.SGON")
-
 ]
diff --git a/optimus_manager/kernel.py b/optimus_manager/kernel.py
index 706f082..f27eb5c 100644
--- a/optimus_manager/kernel.py
+++ b/optimus_manager/kernel.py
@@ -266,6 +266,7 @@ def _set_acpi_call_state(state):
         if not "Error" in output:
             logger.info("ACPI string %s works, saving", string)
             working_strings.append((off_str, on_str))
+            break
 
     var.write_last_acpi_call_state(state)
     var.write_acpi_call_strings(working_strings)
